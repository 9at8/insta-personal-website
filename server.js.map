{"version":3,"sources":["webpack:///webpack/bootstrap 896b695dff331e87564e","webpack:///./index.js","webpack:///external \"path\"","webpack:///external \"express\"","webpack:///external \"body-parser\"","webpack:///external \"mongodb\"","webpack:///external \"axios\""],"names":["app","use","json","static","join","__dirname","url","posts","miniPosts","connect","err","db","collection","memeUrl","tag","process","env","GIPHY_API_KEY","get","req","res","params","then","image","data","image_url","find","type","sort","toArray","toSend","findOne","_id","postID","put","Promise","all","updateOne","$inc","likes","body","numberOfProjects","count","numberOfJobs","$text","$search","query","q","score","$meta","map","post","toString","sendFile","resolve","listen"],"mappings":"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","file":"server.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 896b695dff331e87564e","import path from 'path'\nimport express from 'express'\nimport bodyParser from 'body-parser'\nimport { MongoClient, ObjectId } from 'mongodb'\nimport axios from 'axios'\n\nconst app = express()\napp.use(bodyParser.json())\napp.use('/static', express.static(path.join(__dirname, 'public')))\n\nconst url = 'mongodb://localhost/personal-website'\nlet posts, miniPosts\n\nMongoClient.connect(url, (err, db) => {\n  posts = db.collection('posts')\n  miniPosts = db.collection('miniPosts')\n})\n\nfunction memeUrl(tag) {\n  if (tag === 'random') tag = 'meme'\n  return `https://api.giphy.com/v1/gifs/random?api_key=${process.env.GIPHY_API_KEY}&tag=${tag}&rating=PG-13`\n}\n\napp.get('/api/meme/:tag', (req, res) => {\n  axios.get(memeUrl(req.params.tag))\n    .then(data => res.json({ image: data.data.data.image_url }))\n})\n\n// Return all explore posts with {type: :type}\napp.get('/api/posts/:type', (req, res) => {\n  posts.find({ type: req.params.type }).sort({ 'time': -1 }).toArray()\n  //posts.find({}).sort({'time': -1}).toArray()\n    .then(toSend => res.json(toSend))\n})\n\n// Return post with {_id: postID}\napp.get('/api/post/:postID', (req, res) => {\n  posts.findOne({ _id: ObjectId(req.params.postID) })\n    .then(toSend => res.json(toSend))\n})\n\n// Handles likes or unlikes on MongoDB\napp.put('/api/post/:postID', (req, res) => {\n  Promise.all([\n    posts.updateOne({ _id: ObjectId(req.params.postID) }, { $inc: { likes: req.body.likes } }),\n    miniPosts.updateOne({ postID: req.params.postID }, { $inc: { likes: req.body.likes } }),\n  ])\n    .then(toSend => res.json(toSend))\n})\n\n// Return all miniPosts with {type: :type}\napp.get('/api/miniPosts/:type', (req, res) => {\n  miniPosts.find({ type: req.params.type }).sort({ 'time': -1 }).toArray()\n    .then(toSend => res.json(toSend))\n})\n\n// Return all miniPosts\napp.get('/api/miniPosts', (req, res) => {\n  miniPosts.find({}).sort({ 'time': -1 }).toArray()\n    .then(toSend => res.json(toSend))\n})\n\n// Returns the number of projects and jobs for stats\napp.get('/api/stats', (req, res) => {\n  let numberOfProjects = miniPosts.count({ type: 'project' })\n  let numberOfJobs = miniPosts.count({ type: 'experience' })\n  Promise.all([ numberOfProjects, numberOfJobs ])\n    .then(data => {\n      const numberOfProjects = data[ 0 ]\n      const numberOfJobs = data[ 1 ]\n      res.json({ numberOfProjects, numberOfJobs })\n    })\n})\n\n\n// Returns all miniPosts after searching posts {$search: :query}\n// Sorted by textScore\napp.get('/api/search/posts', (req, res) => {\n  posts.find(\n    { $text: { $search: req.query.q } },\n    { score: { $meta: 'textScore' } })\n    .sort({ score: { $meta: 'textScore' } })\n    .toArray()\n    .then(posts => {\n      return Promise.all(posts.map(post => {\n        return miniPosts.findOne({ postID: post._id.toString() })\n      }))\n    })\n    .then(miniPosts => res.json(miniPosts))\n})\n\napp.get('*', function (req, res) {\n  res.sendFile(path.resolve(__dirname, 'public/index.html'))\n})\n\napp.listen(58080)\n\n\n\n// WEBPACK FOOTER //\n// ./index.js","module.exports = require(\"path\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"path\"\n// module id = 1\n// module chunks = 0","module.exports = require(\"express\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express\"\n// module id = 2\n// module chunks = 0","module.exports = require(\"body-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"body-parser\"\n// module id = 3\n// module chunks = 0","module.exports = require(\"mongodb\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"mongodb\"\n// module id = 4\n// module chunks = 0","module.exports = require(\"axios\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"axios\"\n// module id = 5\n// module chunks = 0"],"sourceRoot":""}